<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SOFS11: sofs_superblock.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>sofs_superblock.h</h1><a href="sofs__superblock_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00013"></a>00013 <span class="preprocessor">#ifndef SOFS_SUPERBLOCK_H_</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#define SOFS_SUPERBLOCK_H_</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;stdint.h&gt;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="sofs__const_8h.html" title="Definition of basic constants.">sofs_const.h</a>&quot;</span>
<a name="l00019"></a>00019 
<a name="l00021"></a><a class="code" href="sofs__superblock_8h.html#a54061e5993a5517320d425f44408cc86">00021</a> <span class="preprocessor">#define MAGIC_NUMBER (0x65FE)</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00024"></a><a class="code" href="sofs__superblock_8h.html#affb1ffbd24de6be88bd8ac877aae1688">00024</a> <span class="preprocessor">#define VERSION_NUMBER (0x2011)</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00027"></a><a class="code" href="sofs__superblock_8h.html#a8ec7917ef708e5650356892410c1731d">00027</a> <span class="preprocessor">#define PARTITION_NAME_SIZE (24)</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span>
<a name="l00030"></a><a class="code" href="sofs__superblock_8h.html#afb43e6232e4956247729eca84f752f4b">00030</a> <span class="preprocessor">#define PRU 0</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00033"></a><a class="code" href="sofs__superblock_8h.html#ab8e692b6f5a0ca4b09a2fbbbe20c2056">00033</a> <span class="preprocessor">#define NPRU 1</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00036"></a><a class="code" href="sofs__superblock_8h.html#aca04cd0c38fd7f8aecc69a60019d57eb">00036</a> <span class="preprocessor">#define NULL_BLOCK ((uint32_t)(~0UL))</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00039"></a><a class="code" href="sofs__superblock_8h.html#af08f5445fdda6b23d72b042ad3877bd0">00039</a> <span class="preprocessor">#define DZONE_CACHE_SIZE  (50)</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00047"></a><a class="code" href="structf_c_node.html">00047</a> <span class="keyword">struct </span><a class="code" href="structf_c_node.html" title="Definition of the reference cache data type.">fCNode</a>
<a name="l00048"></a>00048     {
<a name="l00050"></a><a class="code" href="structf_c_node.html#aa732882de5215ec3ee111c26306179c1">00050</a>         uint32_t <a class="code" href="structf_c_node.html#aa732882de5215ec3ee111c26306179c1" title="index of the first filled/free array element">cache_idx</a>;
<a name="l00052"></a><a class="code" href="structf_c_node.html#af099d96ee3cdb720ddd36c8b9e22afee">00052</a>         uint32_t <a class="code" href="structf_c_node.html#af099d96ee3cdb720ddd36c8b9e22afee" title="storage area whose elements are the logical numbers of free data clusters">cache</a>[<a class="code" href="sofs__superblock_8h.html#af08f5445fdda6b23d72b042ad3877bd0" title="size of cache">DZONE_CACHE_SIZE</a>];
<a name="l00053"></a>00053     };
<a name="l00054"></a>00054 
<a name="l00076"></a><a class="code" href="structso_super_block.html">00076</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structso_super_block.html" title="Definition of the superblock data type.">soSuperBlock</a>
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078   <span class="comment">/* Header */</span>
<a name="l00079"></a>00079 
<a name="l00081"></a><a class="code" href="structso_super_block.html#a57f54349f4fd1cbbb52058812e146af2">00081</a>     uint32_t <a class="code" href="structso_super_block.html#a57f54349f4fd1cbbb52058812e146af2" title="magic number - file system identification number (should be MAGIC_NUMBER macro value)...">magic</a>;
<a name="l00083"></a><a class="code" href="structso_super_block.html#acd99bb05ca015e7d74448acb1deba7ca">00083</a>     uint32_t <a class="code" href="structso_super_block.html#acd99bb05ca015e7d74448acb1deba7ca" title="version number (should be VERSION_NUMBER macro value)">version</a>;
<a name="l00085"></a><a class="code" href="structso_super_block.html#a3efccb6a6868d7bc95f66e2470f88f7f">00085</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structso_super_block.html#a3efccb6a6868d7bc95f66e2470f88f7f" title="volume name">name</a>[<a class="code" href="sofs__superblock_8h.html#a8ec7917ef708e5650356892410c1731d" title="maximum length + 1 of volume name">PARTITION_NAME_SIZE</a>];
<a name="l00087"></a><a class="code" href="structso_super_block.html#a4465b044b838c0a1c1691c56021b66b8">00087</a>     uint32_t <a class="code" href="structso_super_block.html#a4465b044b838c0a1c1691c56021b66b8" title="total number of blocks in the device">ntotal</a>;
<a name="l00092"></a><a class="code" href="structso_super_block.html#a676bfdb32438cabd2d9f2dca28434a54">00092</a>     uint32_t <a class="code" href="structso_super_block.html#a676bfdb32438cabd2d9f2dca28434a54" title="flag signaling if the file system was properly unmounted the last time it was mounted...">mstat</a>;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   <span class="comment">/* Inode table metadata */</span>
<a name="l00095"></a>00095 
<a name="l00097"></a><a class="code" href="structso_super_block.html#ade52c490e89e3c1e3a16a1398d573202">00097</a>     uint32_t <a class="code" href="structso_super_block.html#ade52c490e89e3c1e3a16a1398d573202" title="physical number of the block where the table of inodes starts">itable_start</a>;
<a name="l00099"></a><a class="code" href="structso_super_block.html#a1d232f6258b1ec6d9ca282f0a79d2b04">00099</a>     uint32_t <a class="code" href="structso_super_block.html#a1d232f6258b1ec6d9ca282f0a79d2b04" title="number of blocks that the table of inodes comprises">itable_size</a>;
<a name="l00101"></a><a class="code" href="structso_super_block.html#aba3d4338802a6c1bf58962d3e16b3909">00101</a>     uint32_t <a class="code" href="structso_super_block.html#aba3d4338802a6c1bf58962d3e16b3909" title="total number of inodes">itotal</a>;
<a name="l00103"></a><a class="code" href="structso_super_block.html#a72b97da58c5a966ece645e142152de37">00103</a>     uint32_t <a class="code" href="structso_super_block.html#a72b97da58c5a966ece645e142152de37" title="number of free inodes">ifree</a>;
<a name="l00106"></a><a class="code" href="structso_super_block.html#a6a0de75f5bc887c532cbb42548d9211f">00106</a>     uint32_t <a class="code" href="structso_super_block.html#a6a0de75f5bc887c532cbb42548d9211f" title="index of the array element that forms the head of the double-linked list of free...">ihead</a>;
<a name="l00109"></a><a class="code" href="structso_super_block.html#a52fb68a6cffc86888bcd658bdfbf5474">00109</a>     uint32_t <a class="code" href="structso_super_block.html#a52fb68a6cffc86888bcd658bdfbf5474" title="index of the array element that forms the tail of the double-linked list of free...">itail</a>;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111   <span class="comment">/* Data zone metadata */</span>
<a name="l00112"></a>00112 
<a name="l00114"></a><a class="code" href="structso_super_block.html#a7098af80da9eab830dd64910095a3aa8">00114</a>     uint32_t <a class="code" href="structso_super_block.html#a7098af80da9eab830dd64910095a3aa8" title="physical number of the block where the data zone starts (physical number of the first...">dzone_start</a>;
<a name="l00116"></a><a class="code" href="structso_super_block.html#a86cb58bea2c265833de31dcbac0ee748">00116</a>     uint32_t <a class="code" href="structso_super_block.html#a86cb58bea2c265833de31dcbac0ee748" title="total number of data clusters">dzone_total</a>;
<a name="l00118"></a><a class="code" href="structso_super_block.html#a6653929e031b0294ae343172a51fb786">00118</a>     uint32_t <a class="code" href="structso_super_block.html#a6653929e031b0294ae343172a51fb786" title="number of free data clusters">dzone_free</a>;
<a name="l00120"></a><a class="code" href="structso_super_block.html#a0bdfbac85d748ee37f0d7c6606fdd774">00120</a>     <span class="keyword">struct </span><a class="code" href="structf_c_node.html" title="Definition of the reference cache data type.">fCNode</a> <a class="code" href="structso_super_block.html#a0bdfbac85d748ee37f0d7c6606fdd774" title="retrieval cache of references (or logical numbers) to free data clusters">dzone_retriev</a>;
<a name="l00122"></a><a class="code" href="structso_super_block.html#af04a6d7d692e6a150beda38652081018">00122</a>     <span class="keyword">struct </span><a class="code" href="structf_c_node.html" title="Definition of the reference cache data type.">fCNode</a> <a class="code" href="structso_super_block.html#af04a6d7d692e6a150beda38652081018" title="insertion cache of references (or logical numbers) to free data clusters">dzone_insert</a>;
<a name="l00125"></a><a class="code" href="structso_super_block.html#ac17ea0bba64c20312cae9a07a292fa91">00125</a>     uint32_t <a class="code" href="structso_super_block.html#ac17ea0bba64c20312cae9a07a292fa91" title="logical number of the data cluster that forms the head of the double-linked list...">dhead</a>;
<a name="l00128"></a><a class="code" href="structso_super_block.html#af957190452b79b46ce080fdf6fba3e44">00128</a>     uint32_t <a class="code" href="structso_super_block.html#af957190452b79b46ce080fdf6fba3e44" title="logical number of the data cluster that forms the tail of the double-linked list...">dtail</a>;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130   <span class="comment">/* Padded area to ensure superblock structure is BLOCK_SIZE bytes long */</span>
<a name="l00131"></a>00131 
<a name="l00133"></a><a class="code" href="structso_super_block.html#acd55fdc89beb6b74fc4d4e20bfd0c711">00133</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structso_super_block.html#acd55fdc89beb6b74fc4d4e20bfd0c711" title="reserved area">reserved</a>[<a class="code" href="sofs__const_8h.html#ad51ded0bbd705f02f73fc60c0b721ced" title="block size (in bytes)">BLOCK_SIZE</a> - <a class="code" href="sofs__superblock_8h.html#a8ec7917ef708e5650356892410c1731d" title="maximum length + 1 of volume name">PARTITION_NAME_SIZE</a> - 15 * <span class="keyword">sizeof</span>(uint32_t) - 2 * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structf_c_node.html" title="Definition of the reference cache data type.">fCNode</a>)];
<a name="l00134"></a>00134 } <a class="code" href="structso_super_block.html" title="Definition of the superblock data type.">SOSuperBlock</a>;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="preprocessor">#endif </span><span class="comment">/* SOFS_SUPERBLOCK_H_ */</span>
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
